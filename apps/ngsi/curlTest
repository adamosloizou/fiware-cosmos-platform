#
# 1. Populate with ConferenceRoom and OfficeRoom
#    % curlTest reg firstReg
#
# 2. Add attribute 'pressure' to ConferenceRoom
#    % curlTest reg firstRegAddPressureToConferenceRoom <REGISTRATIONID>
#
# 3. Change metadata 'cm2' value from 'XXX' to 'YYY'
#    % curlTest reg firstRegChangecm2ForOfficeRoom <REGISTRATIONID>
#    ERROR: cm2 isn't updated, another 'cm2' is added to DB ...
#

operation=$1
dataFile=$2
registrationId=$3

if [ "$operation" = "" ]
then
  echo usage: $0 '<operation> <data file> [<registrationId>]'
  exit 1
fi

if [ "$dataFile" = "" ]
then
  echo usage: $0 '<operation> <data file> [<registrationId>]'
  exit 1
fi


if [ "$registrationId" != "" ]
then
  data=$(cat curlData/$dataFile | sed "s/REGISTRATIONID/$registrationId/")
else
  data=$(cat curlData/$dataFile)
fi

echo
echo data: "'" $data "'"
echo

if [ "$operation" == "reg" ]
then
  curl 'localhost:1025/NGSI9/registerContext' --header 'Content-Type: text/xml' -vvvvv -d "$data"
else
  curl 'localhost:1025/NGSI9/discoverContextAvailability' --header 'Content-Type: text/xml' -vvvvv -d "$data"
fi

