Module simple_mobility
{
    title   "Simple mobility example"
    author  "Andreu Urruela"
    version "0.1.1"
}

# Record stored for each user

data User
{
	mobility.Position position;               # Last known position
	system.Int8 track;						  # Flag to indicate if we want to track this user		 
	vector mobility.Area areas;	  			  # Areas defined for this user
}

parser parser_cdrs
{
	out system.UInt mobility.Record
	helpLine "Parse input CDRs to get user - position -timestamp elements"
}

parser parser_commands
{
	out system.UInt system.StringVector
	helpLine "Parse input txt commands to update internal state of users"
}

reduce reduce_cdrs
{
	in system.UInt mobility.Record
	in system.UInt simple_mobility.User
	out system.UInt system.String
	out system.String plot.LevelUpdate
	out system.UInt simple_mobility.User

	helpLine "Update internal state"
}

reduce reduce_commands
{
	in system.UInt system.StringVector
	in system.UInt simple_mobility.User
	out system.UInt system.String
	out system.String plot.LevelUpdate
	out system.UInt simple_mobility.User

	helpLine "Update internal state"
}
	