
/**
 File autogenerated with samsonModuleParser. Please, edit to complete this operation
*/

#ifndef _H_SAMSON_txt_mongo_data_gen
#define _H_SAMSON_txt_mongo_data_gen


#include <samson/module/samson.h>


namespace samson {
namespace txt_md {


class mongo_data_gen : public samson::Generator
{
public:
	bool active;

	
	void init( samson::KVWriter *writer )
	{
	}

	void setup( int worker , int num_workers, int process , int num_processes )
	{
		if ((worker == 0)  && (process == 0))
			active = true;
		else
			active = false;
	}

	void run(samson::KVWriter* writer)
	{
		if (!active)
			return;

		samson::system::UInt      key;
		samson::txt_md::BulkData  value;
		
		for (int ix = 0; ix < 1000; ix++)
		{
			key.value = ix;
			value.position.value = ix * ix;
			value.timestamp.value = ix * ix * ix;

			writer->emit(0, &key, &value);
		}
	}

	void finish( samson::KVWriter *writer )
	{
	}
};


} // end of namespace txt_md
} // end of namespace samson

#endif
