
/**
 File autogenerated with samsonModuleParser. Please, edit to complete this operation
*/

#ifndef _H_SAMSON_sna_search_node_in_graph
#define _H_SAMSON_sna_search_node_in_graph


#include <samson/Operation.h>
#include <samson/Log.h>
#include "sna_environment_parameters.h"


namespace ss{
namespace sna{


	class search_node_in_graph : public ss::Map
	{
		Node node ;
		ss::system::UInt nodeId, searchId ;

	public:

		void init()
		{
			std::string nodeIdStr = environment->get(SNA_PARAMETER_NODEIDSTR, SNA_PARAMETER_NODEIDSTR_DEFAULT);

			if( nodeIdStr.compare(SNA_PARAMETER_NODEIDSTR_DEFAULT) != 0)
			{
				searchId.value = atoll(nodeIdStr.c_str());
				OLM_T(LMT_User01, ("Searching for node:%d", searchId.value));
			}
			else
			{
				OLM_E(("Required parameter not found: nodeId(%s)", SNA_PARAMETER_NODEIDSTR_DEFAULT));
				return;
			}
		}

		void run(  ss::KVSetStruct* inputs , ss::KVWriter *writer )
		{

			for (int i = 0; i < inputs[0].num_kvs; i++)
			{
				nodeId.parse(inputs[0].kvs[i]->key);
				if (nodeId.value == searchId.value)
				{
					node.parse(inputs[0].kvs[i]->value);
					writer->emit(0, &nodeId, &node);
				}
			}
		}


	};


} // end of namespace ss
} // end of namespace sna

#endif
