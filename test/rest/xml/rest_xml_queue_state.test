--NAME--
REST XML /samson/queues/words_count/state
--SHELL--
delilah ${SAMSON_LOG_LEVELS} -log_classic ${SAMSON_TEST_HOST} ${SAMSON_WORKER_PORT_ENV} -command remove_all_stream 2>/dev/null
delilah ${SAMSON_LOG_LEVELS} -log_classic ${SAMSON_TEST_HOST} ${SAMSON_WORKER_PORT_ENV} -command "add_stream_operation o1 txt.parser_words input words" 2>/dev/null
delilah ${SAMSON_LOG_LEVELS} -log_classic ${SAMSON_TEST_HOST} ${SAMSON_WORKER_PORT_ENV}  -command "add_stream_operation o2 txt.word_count_accumulate words words_count words_count" 2>/dev/null
delilah ${SAMSON_LOG_LEVELS} -log_classic ${SAMSON_TEST_HOST} ${SAMSON_WORKER_PORT_ENV}  -command "push input.txt input" 2>/dev/null
delilah ${SAMSON_LOG_LEVELS} -log_classic ${SAMSON_TEST_HOST} ${SAMSON_WORKER_PORT_ENV}  -command flush_buffers 2>/dev/null
delilah ${SAMSON_LOG_LEVELS} -log_classic ${SAMSON_TEST_HOST} ${SAMSON_WORKER_PORT_ENV}  -command "wait" 2>/dev/null
curl -s http://localhost:${SAMSON_WORKER_WEB_PORT_ENV}/samson/queues/words_count/state/015211078.xml
--EXPECT--
<?xml version="1.0" encoding="UTF-8"?>
<!-- SAMSON Rest interface -->
<samson>
<key>
<![CDATA[015211078]]>
</key>
<value>
4</value>

</samson>
