#
# Checking command line options
#
if [ "$#" != 2 ]
then
	echo 'samsonDeb: Bad parameters'
	echo 'Usage: samsonDeb <Version (e.g. 0.5)> <Release (e.g. 3)>'
	exit 1
fi



#
# Using command line options
#
version=$1
release=$2



#
# Help variables
#
arch=$(dpkg --print-architecture)



#
# Populating $HOME/debian
#
rm -rf $HOME/debian

mkdir -p $HOME/debian/DEBIAN
mkdir -p $HOME/debian/usr/local/bin
mkdir -p $HOME/debian/usr/local/include
mkdir -p $HOME/debian/
mkdir -p $HOME/debian/opt/samson/etc

echo "Package: samson"                                   > $HOME/debian/DEBIAN/control
echo "Version: $version"                                >> $HOME/debian/DEBIAN/control
echo "Architecture: $arch"                              >> $HOME/debian/DEBIAN/control
echo "Maintainer: Andreu Urruela <andreu@tid.es>"       >> $HOME/debian/DEBIAN/control
echo "Description: The Samson Map Reduce Platform ..."  >> $HOME/debian/DEBIAN/control

cp /usr/local/bin/samsonCat              $HOME/debian/usr/local/bin
cp /usr/local/bin/samsonController       $HOME/debian/usr/local/bin
cp /usr/local/bin/samsonData             $HOME/debian/usr/local/bin
cp /usr/local/bin/samsonLocal            $HOME/debian/usr/local/bin
cp /usr/local/bin/samsonModuleParser     $HOME/debian/usr/local/bin
cp /usr/local/bin/samsonSetup            $HOME/debian/usr/local/bin
cp /usr/local/bin/samsonSpawner          $HOME/debian/usr/local/bin
cp /usr/local/bin/samsonWorker           $HOME/debian/usr/local/bin
cp /usr/local/bin/delilah                $HOME/debian/usr/local/bin
cp /opt/samson/etc/setup.txt             $HOME/debian/opt/samson/etc/
cp -R /usr/local/man/                    $HOME/debian/usr/local/



#
# Create package
#
cd
dpkg-deb --build debian
cd -
mv ~/debian.deb samson-$version.$release.deb
