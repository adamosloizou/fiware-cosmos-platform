--NAME--
system.value operations - Simple operations with system.value data-type
--DELILAH-INIT--
remove_all
push quijote.txt input
push_module ${SAMSON_HOME}/modules/libsystem.so
flush_buffers
run system.parse -input input -output lines
flush_buffers
run system.map -input lines -output words env:command " parse_words |  emit "
flush_buffers
run system.map -input words -output lengths env:command " select  strlen(key) , 1 | emit "
flush_buffers
run system.reduce -input lengths -output lengths_total env:command sum
flush_buffers
pop lengths_total /tmp/lengths_total -force
--SHELL--
samsonCat /tmp/lengths_total | sort -n
--EXPECT--
1 28973
2 88180
3 65591
4 36312
5 45288
6 36321
7 29572
8 19837
9 12916
10 7283
11 3177
12 1721
13 830
14 337
15 110
16 41
17 7
18 2
19 2
21 1
