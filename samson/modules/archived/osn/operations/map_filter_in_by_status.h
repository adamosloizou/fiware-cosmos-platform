/*
 * Telefónica Digital - Product Development and Innovation
 *
 * THIS CODE AND INFORMATION ARE PROVIDED "AS IS" WITHOUT WARRANTY OF ANY KIND,
 * EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND/OR FITNESS FOR A PARTICULAR PURPOSE.
 *
 * Copyright (c) Telefónica Investigación y Desarrollo S.A.U.
 * All rights reserved.
 */

/**
 File autogenerated with samsonModuleParser. Please, edit to complete this operation
*/

#ifndef _H_SAMSON_osn_map_filter_in_by_status
#define _H_SAMSON_osn_map_filter_in_by_status


#include <samson/module/samson.h>
#include <string>



namespace samson{
namespace osn{


	class map_filter_in_by_status : public samson::Map
	{
		samson::system::String key;
		samson::osn::URLConnection  connect;
		samson::system::UInt value_out;

	public:


		void run(  samson::KVSetStruct* inputs , samson::KVWriter *writer )
		{
			samson::system::UInt16 status;
			status.value = environment->getInt("osn.status_query", 404);



			for (size_t i=0; (i < inputs[0].num_kvs); i++)
			{
				key.parse(inputs[0].kvs[i]->key);
				connect.parse(inputs[0].kvs[i]->value);

				if (connect.status.value == status.value)
				{


					writer->emit(0, &key, &connect);
				}
				else
				{
					;
				}

			}
			samson::system::UInt key_total;
			samson::system::UInt val_total;
			key_total.value = 1;
			val_total.value = inputs[0].num_kvs;
			writer->emit(1, &key_total, &val_total);
		}
	};


} // end of namespace samson
} // end of namespace osn

#endif
