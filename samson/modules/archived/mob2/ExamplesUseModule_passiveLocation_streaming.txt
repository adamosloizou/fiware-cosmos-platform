trace on

add_stream_operation 0_parse_state mob2.parse_user_state state.txt userState
add_stream_operation 0_parse_xmls mob2.parse_xml_ARCANUM xmls.txt xmls phoneImeis imeisPhone tacsPhone userInfo
#add_stream_operation 1_update_state mob2.reduce_update_last_position xmls userState userState
#add_stream_operation 2_check_imeis mob2.reduce_check_imeis_by_user userInfo userState imeiAlarm userState
add_stream_operation 1_update_state mob2.reduce_user_info userInfo userState imeiAlarm userState

#push emptyState state.txt
push XMLs xmls.txt

run mob2.reduce_update_last_position xmls userState userState2
run mob2.reduce_check_imeis_by_user userInfo userState2 imeiAlarm userState3

run mob2.reduce_user_info userInfo userState imeiAlarm userState

rm -f userState
mv userState3 userState

remove_all
rm imeiAlarm imeisPhone phoneImeis state.txt tacsPhone userState xmls xmls.txt userInfo userState2 userState3


#########################################################

trace on

add state.txt -txt
add xmls.txt -txt

upload emptyState state.txt 
upload XMLs xmls.txt

mob2.parse_user_state state.txt userState -create -clear
mob2.parse_xml_ARCANUM xmls.txt xmls phoneImeis imeisPhone tacsPhone userInfo -create -clear

mob2.reduce_update_last_position xmls userState userState2 -create -clear
mob2.reduce_check_imeis_by_user userInfo userState2 imeiAlarm userState3 -create -clear

rm -f userState
mv userState3 userState

